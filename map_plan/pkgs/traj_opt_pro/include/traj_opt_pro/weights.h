// Copyright 2016 Michael Watterson
#ifndef QP_TRAJ_OPT_UTILS_WEIGHTS_H_
#define QP_TRAJ_OPT_UTILS_WEIGHTS_H_

struct QuadWeights {
  /* n = 2 */
  constexpr static double x2[1] = {0.5773502691896257645091488};
  constexpr static double w2[1] = {1.0000000000000000000000000};

  /* n = 4 */
  constexpr static double x4[2] = {0.3399810435848562648026658,
                                   0.8611363115940525752239465};
  constexpr static double w4[2] = {0.6521451548625461426269361,
                                   0.3478548451374538573730639};

  /* n = 6 */
  constexpr static double x6[3] = {0.2386191860831969086305017,
                                   0.6612093864662645136613996,
                                   0.9324695142031520278123016};
  constexpr static double w6[3] = {0.4679139345726910473898703,
                                   0.3607615730481386075698335,
                                   0.1713244923791703450402961};

  /* n = 8 */
  constexpr static double x8[4] = {
      0.1834346424956498049394761, 0.5255324099163289858177390,
      0.7966664774136267395915539, 0.9602898564975362316835609};
  constexpr static double w8[4] = {
      0.3626837833783619829651504, 0.3137066458778872873379622,
      0.2223810344533744705443560, 0.1012285362903762591525314};

  /* n = 10 */
  constexpr static double x10[5] = {
      0.1488743389816312108848260, 0.4333953941292471907992659,
      0.6794095682990244062343274, 0.8650633666889845107320967,
      0.9739065285171717200779640};
  constexpr static double w10[5] = {
      0.2955242247147528701738930, 0.2692667193099963550912269,
      0.2190863625159820439955349, 0.1494513491505805931457763,
      0.0666713443086881375935688};

  /* n = 12 */
  constexpr static double x12[6] = {
      0.1252334085114689154724414, 0.3678314989981801937526915,
      0.5873179542866174472967024, 0.7699026741943046870368938,
      0.9041172563704748566784659, 0.9815606342467192506905491};
  constexpr static double w12[6] = {
      0.2491470458134027850005624, 0.2334925365383548087608499,
      0.2031674267230659217490645, 0.1600783285433462263346525,
      0.1069393259953184309602547, 0.0471753363865118271946160};

  /* n = 14 */
  constexpr static double x14[7] = {
      0.1080549487073436620662447, 0.3191123689278897604356718,
      0.5152486363581540919652907, 0.6872929048116854701480198,
      0.8272013150697649931897947, 0.9284348836635735173363911,
      0.9862838086968123388415973};
  constexpr static double w14[7] = {
      0.2152638534631577901958764, 0.2051984637212956039659241,
      0.1855383974779378137417166, 0.1572031671581935345696019,
      0.1215185706879031846894148, 0.0801580871597602098056333,
      0.0351194603317518630318329};

  /* n = 16 */
  constexpr static double x16[8] = {
      0.0950125098376374401853193, 0.2816035507792589132304605,
      0.4580167776572273863424194, 0.6178762444026437484466718,
      0.7554044083550030338951012, 0.8656312023878317438804679,
      0.9445750230732325760779884, 0.9894009349916499325961542};
  constexpr static double w16[8] = {
      0.1894506104550684962853967, 0.1826034150449235888667637,
      0.1691565193950025381893121, 0.1495959888165767320815017,
      0.1246289712555338720524763, 0.0951585116824927848099251,
      0.0622535239386478928628438, 0.0271524594117540948517806};

  /* n = 18 */
  constexpr static double x18[9] = {
      0.0847750130417353012422619, 0.2518862256915055095889729,
      0.4117511614628426460359318, 0.5597708310739475346078715,
      0.6916870430603532078748911, 0.8037049589725231156824175,
      0.8926024664975557392060606, 0.9558239495713977551811959,
      0.9915651684209309467300160};
  constexpr static double w18[9] = {
      0.1691423829631435918406565, 0.1642764837458327229860538,
      0.1546846751262652449254180, 0.1406429146706506512047313,
      0.1225552067114784601845191, 0.1009420441062871655628140,
      0.0764257302548890565291297, 0.0497145488949697964533349,
      0.0216160135264833103133427};

  /* n = 20 */
  constexpr static double x20[10] = {
      0.0765265211334973337546404, 0.2277858511416450780804962,
      0.3737060887154195606725482, 0.5108670019508270980043641,
      0.6360536807265150254528367, 0.7463319064601507926143051,
      0.8391169718222188233945291, 0.9122344282513259058677524,
      0.9639719272779137912676661, 0.9931285991850949247861224};
  constexpr static double w20[10] = {
      0.1527533871307258506980843, 0.1491729864726037467878287,
      0.1420961093183820513292983, 0.1316886384491766268984945,
      0.1181945319615184173123774, 0.1019301198172404350367501,
      0.0832767415767047487247581, 0.0626720483341090635695065,
      0.0406014298003869413310400, 0.0176140071391521183118620};

  /* n = 3 */
  constexpr static double x3[2] = {0.0000000000000000000000000,
                                   0.7745966692414833770358531};
  constexpr static double w3[2] = {0.8888888888888888888888889,
                                   0.5555555555555555555555556};

  /* n = 5 */
  constexpr static double x5[3] = {0.0000000000000000000000000,
                                   0.5384693101056830910363144,
                                   0.9061798459386639927976269};
  constexpr static double w5[3] = {0.5688888888888888888888889,
                                   0.4786286704993664680412915,
                                   0.2369268850561890875142640};

  /* n = 7 */
  constexpr static double x7[4] = {
      0.0000000000000000000000000, 0.4058451513773971669066064,
      0.7415311855993944398638648, 0.9491079123427585245261897};
  constexpr static double w7[4] = {
      0.4179591836734693877551020, 0.3818300505051189449503698,
      0.2797053914892766679014678, 0.1294849661688696932706114};

  /* n = 9 */
  constexpr static double x9[5] = {
      0.0000000000000000000000000, 0.3242534234038089290385380,
      0.6133714327005903973087020, 0.8360311073266357942994298,
      0.9681602395076260898355762};
  constexpr static double w9[5] = {
      0.3302393550012597631645251, 0.3123470770400028400686304,
      0.2606106964029354623187429, 0.1806481606948574040584720,
      0.0812743883615744119718922};

  /* n = 11 */
  constexpr static double x11[6] = {
      0.0000000000000000000000000, 0.2695431559523449723315320,
      0.5190961292068118159257257, 0.7301520055740493240934163,
      0.8870625997680952990751578, 0.9782286581460569928039380};
  constexpr static double w11[6] = {
      0.2729250867779006307144835, 0.2628045445102466621806889,
      0.2331937645919904799185237, 0.1862902109277342514260976,
      0.1255803694649046246346943, 0.0556685671161736664827537};

  /* n = 13 */
  constexpr static double x13[7] = {
      0.0000000000000000000000000, 0.2304583159551347940655281,
      0.4484927510364468528779129, 0.6423493394403402206439846,
      0.8015780907333099127942065, 0.9175983992229779652065478,
      0.9841830547185881494728294};
  constexpr static double w13[7] = {
      0.2325515532308739101945895, 0.2262831802628972384120902,
      0.2078160475368885023125232, 0.1781459807619457382800467,
      0.1388735102197872384636018, 0.0921214998377284479144218,
      0.0404840047653158795200216};

  /* n = 15 */
  constexpr static double x15[8] = {
      0.0000000000000000000000000, 0.2011940939974345223006283,
      0.3941513470775633698972074, 0.5709721726085388475372267,
      0.7244177313601700474161861, 0.8482065834104272162006483,
      0.9372733924007059043077589, 0.9879925180204854284895657};
  constexpr static double w15[8] = {
      0.2025782419255612728806202, 0.1984314853271115764561183,
      0.1861610000155622110268006, 0.1662692058169939335532009,
      0.1395706779261543144478048, 0.1071592204671719350118695,
      0.0703660474881081247092674, 0.0307532419961172683546284};

  /* n = 17 */
  constexpr static double x17[9] = {
      0.0000000000000000000000000, 0.1784841814958478558506775,
      0.3512317634538763152971855, 0.5126905370864769678862466,
      0.6576711592166907658503022, 0.7815140038968014069252301,
      0.8802391537269859021229557, 0.9506755217687677612227170,
      0.9905754753144173356754340};
  constexpr static double w17[9] = {
      0.1794464703562065254582656, 0.1765627053669926463252710,
      0.1680041021564500445099707, 0.1540457610768102880814316,
      0.1351363684685254732863200, 0.1118838471934039710947884,
      0.0850361483171791808835354, 0.0554595293739872011294402,
      0.0241483028685479319601100};

  /* n = 19 */
  constexpr static double x19[10] = {
      0.0000000000000000000000000, 0.1603586456402253758680961,
      0.3165640999636298319901173, 0.4645707413759609457172671,
      0.6005453046616810234696382, 0.7209661773352293786170959,
      0.8227146565371428249789225, 0.9031559036148179016426609,
      0.9602081521348300308527788, 0.9924068438435844031890177};
  constexpr static double w19[10] = {
      0.1610544498487836959791636, 0.1589688433939543476499564,
      0.1527660420658596667788554, 0.1426067021736066117757461,
      0.1287539625393362276755158, 0.1115666455473339947160239,
      0.0914900216224499994644621, 0.0690445427376412265807083,
      0.0448142267656996003328382, 0.0194617882297264770363120};

  constexpr static const double *w[19] = {w2,  w3,  w4,  w5,  w6,  w7,  w8,
                                          w9,  w10, w11, w12, w13, w14, w15,
                                          w16, w17, w18, w19, w20};
  constexpr static const double *x[19] = {x2,  x3,  x4,  x5,  x6,  x7,  x8,
                                          x9,  x10, x11, x12, x13, x14, x15,
                                          x16, x17, x18, x19, x20};

//  static double getWeight(int i, int n) {
//    if (n < 2 || n > 20) return 0.0 / 0.0;
//    double w_raw;
//    if (i % 2 == 0) {
//      w_raw = w[n - 2][i / 2];
//    } else {
//      int j = i - 1;
//      if (j == 0)
//        w_raw = w[n - 2][0];
//      else
//        w_raw = w[n - 2][j / 2 + 1];
//    }
//    return w_raw / 2.0;
//  }

//  static double getPoint(int i, int n) {
//    if (n < 2 || n > 20) return 0.0 / 0.0;
//    double x_raw;
//    double ratio = i % 2 == 0 ? 1 : -1;
//    if (i % 2 == 0) {
//      x_raw = x[n - 2][i / 2];
//    } else {
//      int j = i - 1;
//      if (j == 0)
//        x_raw = x[n - 2][0] * ratio;
//      else
//        x_raw = x[n - 2][j / 2 + 1] * ratio;
//    }
//    return x_raw * 0.5 + 0.5;
//  }
  static double getWeight(int i, int n) {
    if(n!=11)
      throw 22;

    std::vector<double> w{0.2729250867779006307144835, 0.2628045445102466621806889, 0.2628045445102466621806889, 0.2331937645919904799185237, 0.2331937645919904799185237, 0.1862902109277342514260976, 0.1862902109277342514260976, 0.1255803694649046246346943, 0.1255803694649046246346943, 0.0556685671161736664827537, 0.0556685671161736664827537 };
    return w.at(i)*0.5;
  }
  static double getPoint(int i, int n) {
    if(n!=11)
      throw 22;
    std::vector<double> p{0.0 , 0.2695431559523449723315320 , -0.2695431559523449723315320 , 0.5190961292068118159257257 , -0.5190961292068118159257257 , 0.7301520055740493240934163 , -0.7301520055740493240934163 , 0.8870625997680952990751578 , -0.8870625997680952990751578 , 0.9782286581460569928039380 , -0.9782286581460569928039380 };
   return p.at(i)*0.5+0.5;
  }
};

// silly c++, these shouldn't be necessary
constexpr double QuadWeights::w2[];
constexpr double QuadWeights::w3[];
constexpr double QuadWeights::w4[];
constexpr double QuadWeights::w5[];
constexpr double QuadWeights::w6[];
constexpr double QuadWeights::w7[];
constexpr double QuadWeights::w8[];
constexpr double QuadWeights::w9[];
constexpr double QuadWeights::w10[];
constexpr double QuadWeights::w11[];
constexpr double QuadWeights::w12[];
constexpr double QuadWeights::w13[];
constexpr double QuadWeights::w14[];
constexpr double QuadWeights::w15[];
constexpr double QuadWeights::w16[];
constexpr double QuadWeights::w17[];
constexpr double QuadWeights::w18[];
constexpr double QuadWeights::w19[];
constexpr double QuadWeights::w20[];
constexpr double QuadWeights::x2[];
constexpr double QuadWeights::x3[];
constexpr double QuadWeights::x4[];
constexpr double QuadWeights::x5[];
constexpr double QuadWeights::x6[];
constexpr double QuadWeights::x7[];
constexpr double QuadWeights::x8[];
constexpr double QuadWeights::x9[];
constexpr double QuadWeights::x10[];
constexpr double QuadWeights::x11[];
constexpr double QuadWeights::x12[];
constexpr double QuadWeights::x13[];
constexpr double QuadWeights::x14[];
constexpr double QuadWeights::x15[];
constexpr double QuadWeights::x16[];
constexpr double QuadWeights::x17[];
constexpr double QuadWeights::x18[];
constexpr double QuadWeights::x19[];
constexpr double QuadWeights::x20[];
constexpr const double *QuadWeights::w[];
constexpr const double *QuadWeights::x[];

#endif  // QP_TRAJ_OPT_UTILS_WEIGHTS_H_
