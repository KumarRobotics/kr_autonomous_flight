<?xml version="1.0" encoding="UTF-8"?>
<launch>


  <arg name="takeoff_node_start_delay" default="15.0" />  
  <arg name="robot" default="quadrotor" />  
  <arg name="odom" default="/unity_command/ground_truth/$(arg robot)/odom" />
  <arg name="use_lauras" default="false" />

  <include file="$(find dcist_utils)/launch/sim/sim_quad.launch">
    <arg name="robot" value="$(arg robot)" />
    <arg name="odom" value="$(arg odom)" />
  </include>


<group ns="$(arg robot)" if="$(arg use_lauras)">
      <node pkg="motion_primitives"
        type="planning_server.py"
        name="local_plan_server"
        output="screen">
        <rosparam file="$(find control_launch)/config/tracker_params_mp.yaml"/>
        <remap from="voxel_map" to="mapper/local_voxel_map"/>
      </node>
  </group>

  <include file="$(find state_machine_launch)/launch/system_mp.launch">
    <arg name="robot" value="$(arg robot)" />
    <arg name="use_lauras" value="$(arg use_lauras)" />
  </include>

  <include file="$(find client_launch)/launch/client.launch">
    <arg name="robot" value="$(arg robot)" />
  </include>

  <node name="robot" pkg="arl_unity_ros_air" type="rosflight_offboard.py" ns="$(arg robot)" output="screen" launch-prefix="bash -c 'sleep $(arg takeoff_node_start_delay); $0 $@' " />
</launch>
